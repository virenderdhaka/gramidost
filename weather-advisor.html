<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grami Dost - Smart Weather Advisor</title>
    <style>
        :root {
            --primary-green: #1b8a2f;
            --light-green-bg: #e9ffe9;
            --white-cards: #ffffff;
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--light-green-bg);
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            animation: fadeIn 1s ease;
        }

        .logo {
            font-size: 2.5rem;
            color: var(--primary-green);
            margin-bottom: 10px;
        }

        h1 {
            color: var(--primary-green);
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2rem;
            color: #555;
        }

        .card {
            background-color: var(--white-cards);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 20px;
            margin-bottom: 20px;
            transition: var(--transition);
            animation: slideIn 0.5s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }

        .btn {
            background-color: var(--primary-green);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1rem;
            transition: var(--transition);
            margin: 5px;
            display: inline-block;
        }

        .btn:hover {
            background-color: #156b24;
            transform: scale(1.05);
        }

        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary-green);
            color: var(--primary-green);
        }

        .btn-outline:hover {
            background-color: var(--primary-green);
            color: white;
        }

        .input-group {
            margin: 20px 0;
        }

        input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 1rem;
            margin-bottom: 10px;
        }

        .location-options {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin: 30px 0;
        }

        .weather-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .weather-card {
            background-color: var(--white-cards);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 20px;
            transition: var(--transition);
            animation: slideIn 0.5s ease;
        }

        .weather-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }

        .weather-date {
            font-weight: bold;
            color: var(--primary-green);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .weather-icon {
            font-size: 2.5rem;
            margin: 10px 0;
        }

        .weather-details {
            margin-top: 15px;
        }

        .weather-detail {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px solid #eee;
        }

        .temp-hot {
            color: #ff6b35;
        }

        .temp-moderate {
            color: var(--primary-green);
        }

        .temp-cool {
            color: #3498db;
        }

        .crop-suggestion {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8fff8;
            border-radius: var(--border-radius);
            border-left: 4px solid var(--primary-green);
        }

        .alert {
            padding: 15px;
            border-radius: var(--border-radius);
            margin: 15px 0;
            font-weight: bold;
        }

        .alert-warning {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            color: #856404;
        }

        .alert-info {
            background-color: #d1ecf1;
            border-left: 4px solid #17a2b8;
            color: #0c5460;
        }

        .alert-success {
            background-color: #d4edda;
            border-left: 4px solid #28a745;
            color: #155724;
        }

        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary-green);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        .hidden {
            display: none;
        }

        .crop-selector {
            margin: 20px 0;
        }

        select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 1rem;
            margin-bottom: 10px;
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            color: #666;
            font-size: 0.9rem;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .location-options {
                flex-direction: column;
                align-items: center;
            }
            
            .weather-cards {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">üåø</div>
            <h1>SMART WEATHER ADVISOR ‚Äî Grami Dost</h1>
            <p class="subtitle">‡§ï‡§ø‡§∏‡§æ‡§®‡•ã‡§Ç ‡§î‡§∞ ‡§¨‡§æ‡§ó‡§µ‡§æ‡§®‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§ü‡•Ä‡§ï ‡§Æ‡•å‡§∏‡§Æ ‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§®‡•Å‡§Æ‡§æ‡§®</p>
        </header>

        <!-- Start Screen -->
        <div id="start-screen" class="card">
            <h2>‡§ï‡•É‡§™‡§Ø‡§æ ‡§≤‡•ã‡§ï‡•á‡§∂‡§® ‡§ö‡•Å‡§®‡•á‡§Ç:</h2>
            <div class="location-options">
                <button id="auto-detect-btn" class="btn">Auto-detect Location</button>
                <button id="manual-input-btn" class="btn btn-outline">Enter Location Manually</button>
            </div>
            
            <div id="manual-input-section" class="hidden">
                <div class="input-group">
                    <input type="text" id="location-input" placeholder="‡§∂‡§π‡§∞ ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§Ø‡§æ ‡§™‡§ø‡§® ‡§ï‡•ã‡§° ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">
                    <button id="submit-location" class="btn">‡§Æ‡•å‡§∏‡§Æ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç</button>
                </div>
            </div>
        </div>

        <!-- Loading Screen -->
        <div id="loading-screen" class="card hidden">
            <div class="loader"></div>
            <p style="text-align: center;">‡§Æ‡•å‡§∏‡§Æ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à...</p>
        </div>

        <!-- Weather Display -->
        <div id="weather-display" class="hidden">
            <div class="card">
                <h2 id="location-title">‡§Ü‡§™‡§ï‡•á ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§ï‡§æ ‡§Æ‡•å‡§∏‡§Æ</h2>
                
                <div class="crop-selector">
                    <label for="crop-type">‡§´‡§∏‡§≤ ‡§ï‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï):</label>
                    <select id="crop-type">
                        <option value="none">‡§ï‡•ã‡§à ‡§´‡§∏‡§≤ ‡§®‡§π‡•Ä‡§Ç ‡§ö‡•Å‡§®‡•Ä</option>
                        <option value="wheat">‡§ó‡•á‡§π‡•Ç‡§Ç</option>
                        <option value="rice">‡§ß‡§æ‡§®</option>
                        <option value="vegetables">‡§∏‡§¨‡•ç‡§ú‡§ø‡§Ø‡§æ‡§Ç</option>
                        <option value="fruits">‡§´‡§≤</option>
                        <option value="pulses">‡§¶‡§≤‡§π‡§®</option>
                        <option value="oilseeds">‡§§‡§ø‡§≤‡§π‡§®</option>
                    </select>
                </div>
                
                <div id="weather-alert" class="alert hidden"></div>
            </div>

            <div id="weather-cards" class="weather-cards">
                <!-- Weather cards will be dynamically inserted here -->
            </div>

            <div class="card">
                <h3>‡§´‡§∏‡§≤ ‡§∏‡§≤‡§æ‡§π</h3>
                <div id="crop-suggestion" class="crop-suggestion">
                    <!-- Crop suggestions will be dynamically inserted here -->
                </div>
            </div>

            <div class="card">
                <div class="location-options">
                    <button id="refresh-btn" class="btn">‡§§‡§æ‡§ú‡§º‡§æ ‡§ï‡§∞‡•á‡§Ç</button>
                    <button id="change-location" class="btn btn-outline">‡§≤‡•ã‡§ï‡•á‡§∂‡§® ‡§¨‡§¶‡§≤‡•á‡§Ç</button>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>‡§∏‡•ç‡§∞‡•ã‡§§: OpenWeather API</p>
            <p>Grami Dost - ‡§ï‡§ø‡§∏‡§æ‡§®‡•ã‡§Ç ‡§ï‡§æ ‡§∏‡§ö‡•ç‡§ö‡§æ ‡§∏‡§æ‡§•‡•Ä</p>
        </div>
    </div>

    <script>
        // API Configuration
        const API_KEY = "3835eaedb0b957ab8bfb8fe37723dfda"; // <-- Replace with your API key
        const API_URL = "https://api.openweathermap.org/data/2.5/forecast";

        // DOM Elements
        const startScreen = document.getElementById('start-screen');
        const loadingScreen = document.getElementById('loading-screen');
        const weatherDisplay = document.getElementById('weather-display');
        const autoDetectBtn = document.getElementById('auto-detect-btn');
        const manualInputBtn = document.getElementById('manual-input-btn');
        const manualInputSection = document.getElementById('manual-input-section');
        const locationInput = document.getElementById('location-input');
        const submitLocation = document.getElementById('submit-location');
        const locationTitle = document.getElementById('location-title');
        const weatherCards = document.getElementById('weather-cards');
        const cropSuggestion = document.getElementById('crop-suggestion');
        const weatherAlert = document.getElementById('weather-alert');
        const cropType = document.getElementById('crop-type');
        const refreshBtn = document.getElementById('refresh-btn');
        const changeLocation = document.getElementById('change-location');

        // Event Listeners
        autoDetectBtn.addEventListener('click', getLocationByGeolocation);
        manualInputBtn.addEventListener('click', showManualInput);
        submitLocation.addEventListener('click', getWeatherByManualInput);
        refreshBtn.addEventListener('click', refreshWeather);
        changeLocation.addEventListener('click', goBackToStart);
        cropType.addEventListener('change', updateCropSuggestions);

        // Show manual input section
        function showManualInput() {
            manualInputSection.classList.remove('hidden');
        }

        // Get location using geolocation API
        function getLocationByGeolocation() {
            if (!navigator.geolocation) {
                alert("‡§Ü‡§™‡§ï‡•á ‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º‡§∞ ‡§Æ‡•á‡§Ç ‡§ú‡§ø‡§Ø‡•ã‡§≤‡•ã‡§ï‡•á‡§∂‡§® ‡§∏‡§™‡•ã‡§∞‡•ç‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§Æ‡•à‡§®‡•ç‡§Ø‡•Å‡§Ö‡§≤ ‡§≤‡•ã‡§ï‡•á‡§∂‡§® ‡§á‡§®‡§™‡•Å‡§ü ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç‡•§");
                return;
            }

            showLoadingScreen();
            
            navigator.geolocation.getCurrentPosition(
                position => {
                    const lat = position.coords.latitude;
                    const lon = position.coords.longitude;
                    getWeatherDataByCoords(lat, lon);
                },
                error => {
                    hideLoadingScreen();
                    alert("‡§≤‡•ã‡§ï‡•á‡§∂‡§® ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: " + error.message);
                    showManualInput();
                }
            );
        }

        // Get weather by manual input
        function getWeatherByManualInput() {
            const location = locationInput.value.trim();
            if (!location) {
                alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§∂‡§π‡§∞ ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§Ø‡§æ ‡§™‡§ø‡§® ‡§ï‡•ã‡§° ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç");
                return;
            }

            showLoadingScreen();
            getWeatherDataByCity(location);
        }

        // Show loading screen
        function showLoadingScreen() {
            startScreen.classList.add('hidden');
            loadingScreen.classList.remove('hidden');
            weatherDisplay.classList.add('hidden');
        }

        // Hide loading screen
        function hideLoadingScreen() {
            loadingScreen.classList.add('hidden');
        }

        // Get weather data by coordinates
        function getWeatherDataByCoords(lat, lon) {
            const url = `${API_URL}?lat=${lat}&lon=${lon}&appid=${API_KEY}&units=metric&lang=hi`;
            fetchWeatherData(url);
        }

        // Get weather data by city name
        function getWeatherDataByCity(city) {
            const url = `${API_URL}?q=${city}&appid=${API_KEY}&units=metric&lang=hi`;
            fetchWeatherData(url);
        }

        // Fetch weather data from API
        function fetchWeatherData(url) {
            fetch(url)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('‡§Æ‡•å‡§∏‡§Æ ‡§°‡•á‡§ü‡§æ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø');
                    }
                    return response.json();
                })
                .then(data => {
                    hideLoadingScreen();
                    displayWeatherData(data);
                })
                .catch(error => {
                    hideLoadingScreen();
                    alert(error.message);
                });
        }

        // Display weather data
        function displayWeatherData(data) {
            // Update location title
            locationTitle.textContent = `${data.city.name}, ${data.city.country} ‡§ï‡§æ ‡§Æ‡•å‡§∏‡§Æ`;
            
            // Clear previous weather cards
            weatherCards.innerHTML = '';
            
            // Process and display weather data for next 4 days
            const dailyData = processDailyData(data.list);
            
            dailyData.forEach((day, index) => {
                const card = createWeatherCard(day, index);
                weatherCards.appendChild(card);
            });
            
            // Show weather display
            weatherDisplay.classList.remove('hidden');
            
            // Update crop suggestions
            updateCropSuggestions();
            
            // Check for weather alerts
            checkWeatherAlerts(dailyData);
        }

        // Process API data to get daily forecasts
        function processDailyData(weatherList) {
            const dailyData = [];
            const days = {};
            
            // Group data by day
            weatherList.forEach(item => {
                const date = new Date(item.dt * 1000);
                const dayKey = date.toDateString();
                
                if (!days[dayKey]) {
                    days[dayKey] = {
                        date: date,
                        temps: [],
                        humidity: [],
                        weather: [],
                        wind: [],
                        rain: 0
                    };
                }
                
                days[dayKey].temps.push(item.main.temp);
                days[dayKey].humidity.push(item.main.humidity);
                days[dayKey].weather.push(item.weather[0]);
                days[dayKey].wind.push(item.wind.speed);
                
                if (item.rain && item.rain['3h']) {
                    days[dayKey].rain += item.rain['3h'];
                }
            });
            
            // Process data for each day
            let count = 0;
            for (const dayKey in days) {
                if (count >= 4) break;
                
                const dayData = days[dayKey];
                const avgTemp = dayData.temps.reduce((a, b) => a + b, 0) / dayData.temps.length;
                const minTemp = Math.min(...dayData.temps);
                const maxTemp = Math.max(...dayData.temps);
                const avgHumidity = dayData.humidity.reduce((a, b) => a + b, 0) / dayData.humidity.length;
                const avgWind = dayData.wind.reduce((a, b) => a + b, 0) / dayData.wind.length;
                
                // Find most common weather condition
                const weatherCount = {};
                dayData.weather.forEach(w => {
                    const desc = w.description;
                    weatherCount[desc] = (weatherCount[desc] || 0) + 1;
                });
                
                let mainWeather = '';
                let maxCount = 0;
                for (const desc in weatherCount) {
                    if (weatherCount[desc] > maxCount) {
                        maxCount = weatherCount[desc];
                        mainWeather = desc;
                    }
                }
                
                dailyData.push({
                    date: dayData.date,
                    minTemp: minTemp,
                    maxTemp: maxTemp,
                    avgTemp: avgTemp,
                    humidity: avgHumidity,
                    windSpeed: avgWind,
                    weather: mainWeather,
                    rain: dayData.rain
                });
                
                count++;
            }
            
            return dailyData;
        }

        // Create weather card
        function createWeatherCard(dayData, index) {
            const card = document.createElement('div');
            card.className = 'weather-card';
            card.style.animationDelay = `${index * 0.1}s`;
            
            // Format date
            const dateOptions = { day: 'numeric', month: 'short', year: 'numeric' };
            const formattedDate = dayData.date.toLocaleDateString('hi-IN', dateOptions);
            
            // Get weather icon
            const weatherIcon = getWeatherIcon(dayData.weather);
            
            // Temperature class for color coding
            let tempClass = 'temp-moderate';
            if (dayData.avgTemp < 15) tempClass = 'temp-cool';
            if (dayData.avgTemp > 30) tempClass = 'temp-hot';
            
            // Rain probability
            const rainProbability = calculateRainProbability(dayData.rain);
            
            card.innerHTML = `
                <div class="weather-date">${formattedDate}</div>
                <div class="weather-icon">${weatherIcon}</div>
                <div class="weather-details">
                    <div class="weather-detail">
                        <span>üå° ‡§§‡§æ‡§™‡§Æ‡§æ‡§®:</span>
                        <span class="${tempClass}">${Math.round(dayData.minTemp)}¬∞C - ${Math.round(dayData.maxTemp)}¬∞C</span>
                    </div>
                    <div class="weather-detail">
                        <span>‚òÅÔ∏è ‡§Æ‡•å‡§∏‡§Æ:</span>
                        <span>${dayData.weather}</span>
                    </div>
                    <div class="weather-detail">
                        <span>üåß ‡§¨‡§æ‡§∞‡§ø‡§∂:</span>
                        <span>${rainProbability}% ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ</span>
                    </div>
                    <div class="weather-detail">
                        <span>üí® ‡§π‡§µ‡§æ:</span>
                        <span>${Math.round(dayData.windSpeed * 3.6)} km/h</span>
                    </div>
                    <div class="weather-detail">
                        <span>üíß ‡§®‡§Æ‡•Ä:</span>
                        <span>${Math.round(dayData.humidity)}%</span>
                    </div>
                </div>
            `;
            
            return card;
        }

        // Get weather icon based on condition
        function getWeatherIcon(weather) {
            const weatherLower = weather.toLowerCase();
            
            if (weatherLower.includes('‡§¨‡§æ‡§∞‡§ø‡§∂') || weatherLower.includes('rain')) {
                return 'üåß';
            } else if (weatherLower.includes('‡§ß‡•Ç‡§™') || weatherLower.includes('clear')) {
                return '‚òÄÔ∏è';
            } else if (weatherLower.includes('‡§¨‡§æ‡§¶‡§≤') || weatherLower.includes('cloud')) {
                return '‚òÅÔ∏è';
            } else if (weatherLower.includes('‡§π‡§µ‡§æ') || weatherLower.includes('wind')) {
                return 'üí®';
            } else if (weatherLower.includes('‡§¨‡§∞‡•ç‡§´') || weatherLower.includes('snow')) {
                return '‚ùÑÔ∏è';
            } else {
                return 'üå§';
            }
        }

        // Calculate rain probability
        function calculateRainProbability(rainAmount) {
            if (rainAmount > 10) return 80;
            if (rainAmount > 5) return 60;
            if (rainAmount > 2) return 40;
            if (rainAmount > 0.5) return 20;
            return 10;
        }

        // Update crop suggestions based on weather and selected crop
        function updateCropSuggestions() {
            const selectedCrop = cropType.value;
            let suggestion = '';
            
            // Get weather data from displayed cards
            const weatherCards = document.querySelectorAll('.weather-card');
            if (weatherCards.length === 0) return;
            
            // Simple analysis based on first day's weather
            const firstCard = weatherCards[0];
            const tempText = firstCard.querySelector('.temp-moderate, .temp-hot, .temp-cool').textContent;
            const weatherText = firstCard.querySelector('.weather-detail:nth-child(2) span:last-child').textContent;
            const rainText = firstCard.querySelector('.weather-detail:nth-child(3) span:last-child').textContent;
            const windText = firstCard.querySelector('.weather-detail:nth-child(4) span:last-child').textContent;
            
            // Extract numeric values
            const rainProbability = parseInt(rainText);
            const windSpeed = parseInt(windText);
            
            // General suggestions
            if (rainProbability > 50) {
                suggestion += "‡§Ü‡§ú ‡§π‡§≤‡•ç‡§ï‡•Ä ‡§¨‡§æ‡§∞‡§ø‡§∂ ‡§π‡•ã‡§®‡•á ‡§µ‡§æ‡§≤‡•Ä ‡§π‡•à, ‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à ‡§ü‡§æ‡§≤‡•á‡§Ç‡•§ ";
            } else if (rainProbability < 20) {
                suggestion += "‡§¨‡§æ‡§∞‡§ø‡§∂ ‡§ï‡§Æ ‡§π‡•à, ‡§´‡§∏‡§≤ ‡§ï‡•ã ‡§™‡§æ‡§®‡•Ä ‡§¶‡•á‡§Ç‡•§ ";
            }
            
            if (windSpeed > 20) {
                suggestion += "‡§§‡•á‡§ú ‡§π‡§µ‡§æ ‡§ï‡•á ‡§ï‡§æ‡§∞‡§£ ‡§´‡§∏‡§≤ ‡§ï‡•Ä ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§ ";
            }
            
            if (weatherText.includes('‡§ß‡•Ç‡§™') && !weatherText.includes('‡§¨‡§æ‡§¶‡§≤')) {
                suggestion += "‡§ß‡•Ç‡§™ ‡§µ‡§æ‡§≤‡•á ‡§Æ‡•å‡§∏‡§Æ ‡§Æ‡•á‡§Ç ‡§´‡§∏‡§≤ ‡§ï‡•Ä ‡§®‡§ø‡§∞‡§æ‡§à-‡§ó‡•Å‡§°‡§º‡§æ‡§à ‡§ï‡§∞‡•á‡§Ç‡•§ ";
            }
            
            // Crop-specific suggestions
            if (selectedCrop !== 'none') {
                suggestion += getCropSpecificSuggestion(selectedCrop, weatherText, rainProbability);
            }
            
            // If no specific conditions, provide general advice
            if (!suggestion) {
                suggestion = "‡§á‡§∏ ‡§Æ‡•å‡§∏‡§Æ ‡§Æ‡•á‡§Ç ‡§π‡§≤‡•ç‡§ï‡•Ä ‡§´‡§∏‡§≤ ‡§ï‡•Ä ‡§¶‡•á‡§ñ‡§≠‡§æ‡§≤ ‡§ï‡§∞‡•á‡§Ç, ‡§¨‡•Å‡§µ‡§æ‡§à ‡§ü‡§æ‡§≤‡•á‡§Ç‡•§";
            }
            
            cropSuggestion.textContent = suggestion;
        }

        // Get crop-specific suggestions
        function getCropSpecificSuggestion(crop, weather, rainProbability) {
            switch(crop) {
                case 'wheat':
                    if (rainProbability > 60) return "‡§ó‡•á‡§π‡•Ç‡§Ç ‡§ï‡•Ä ‡§´‡§∏‡§≤ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§ß‡§ø‡§ï ‡§¨‡§æ‡§∞‡§ø‡§∂ ‡§π‡§æ‡§®‡§ø‡§ï‡§æ‡§∞‡§ï ‡§π‡•à, ‡§ú‡§≤ ‡§®‡§ø‡§ï‡§æ‡§∏‡•Ä ‡§ï‡§æ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß ‡§ï‡§∞‡•á‡§Ç‡•§";
                    if (weather.includes('‡§ß‡•Ç‡§™')) return "‡§ó‡•á‡§π‡•Ç‡§Ç ‡§ï‡•Ä ‡§´‡§∏‡§≤ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ß‡•Ç‡§™ ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§π‡•à, ‡§ñ‡§æ‡§¶ ‡§°‡§æ‡§≤‡§®‡•á ‡§ï‡§æ ‡§â‡§ö‡§ø‡§§ ‡§∏‡§Æ‡§Ø ‡§π‡•à‡•§";
                    return "‡§ó‡•á‡§π‡•Ç‡§Ç ‡§ï‡•Ä ‡§´‡§∏‡§≤ ‡§ï‡•Ä ‡§®‡§ø‡§Ø‡§Æ‡§ø‡§§ ‡§¶‡•á‡§ñ‡§≠‡§æ‡§≤ ‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡•á‡§Ç‡•§";
                    
                case 'rice':
                    if (rainProbability < 30) return "‡§ß‡§æ‡§® ‡§ï‡•Ä ‡§´‡§∏‡§≤ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡§∞‡•ç‡§Ø‡§æ‡§™‡•ç‡§§ ‡§™‡§æ‡§®‡•Ä ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§";
                    return "‡§ß‡§æ‡§® ‡§ï‡•Ä ‡§´‡§∏‡§≤ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§Æ‡•å‡§∏‡§Æ ‡§Ö‡§®‡•Å‡§ï‡•Ç‡§≤ ‡§π‡•à‡•§";
                    
                case 'vegetables':
                    if (rainProbability > 70) return "‡§∏‡§¨‡•ç‡§ú‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§´‡§∏‡§≤ ‡§ï‡•ã ‡§Ö‡§ß‡§ø‡§ï ‡§¨‡§æ‡§∞‡§ø‡§∂ ‡§∏‡•á ‡§¨‡§ö‡§æ‡§è‡§Ç‡•§";
                    if (weather.includes('‡§ß‡•Ç‡§™')) return "‡§∏‡§¨‡•ç‡§ú‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§´‡§∏‡§≤ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ß‡•Ç‡§™ ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§π‡•à, ‡§ï‡•Ä‡§ü‡§®‡§æ‡§∂‡§ï ‡§ï‡§æ ‡§õ‡§ø‡§°‡§º‡§ï‡§æ‡§µ ‡§ï‡§∞‡•á‡§Ç‡•§";
                    return "‡§∏‡§¨‡•ç‡§ú‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§´‡§∏‡§≤ ‡§ï‡•Ä ‡§®‡§ø‡§Ø‡§Æ‡§ø‡§§ ‡§¶‡•á‡§ñ‡§≠‡§æ‡§≤ ‡§ï‡§∞‡•á‡§Ç‡•§";
                    
                case 'fruits':
                    if (windSpeed > 25) return "‡§´‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§™‡•á‡§°‡§º‡•ã‡§Ç ‡§ï‡•ã ‡§§‡•á‡§ú ‡§π‡§µ‡§æ ‡§∏‡•á ‡§¨‡§ö‡§æ‡§è‡§Ç‡•§";
                    return "‡§´‡§≤‡•ã‡§Ç ‡§ï‡•Ä ‡§´‡§∏‡§≤ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§Æ‡•å‡§∏‡§Æ ‡§Ö‡§®‡•Å‡§ï‡•Ç‡§≤ ‡§π‡•à‡•§";
                    
                case 'pulses':
                    if (rainProbability > 50) return "‡§¶‡§≤‡§π‡§® ‡§´‡§∏‡§≤‡•ã‡§Ç ‡§ï‡•ã ‡§Ö‡§ß‡§ø‡§ï ‡§®‡§Æ‡•Ä ‡§∏‡•á ‡§¨‡§ö‡§æ‡§è‡§Ç‡•§";
                    return "‡§¶‡§≤‡§π‡§® ‡§´‡§∏‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§Æ‡•å‡§∏‡§Æ ‡§Ö‡§®‡•Å‡§ï‡•Ç‡§≤ ‡§π‡•à‡•§";
                    
                case 'oilseeds':
                    if (weather.includes('‡§¨‡§æ‡§¶‡§≤')) return "‡§§‡§ø‡§≤‡§π‡§® ‡§´‡§∏‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ß‡•Ç‡§™ ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•à‡•§";
                    return "‡§§‡§ø‡§≤‡§π‡§® ‡§´‡§∏‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§Æ‡•å‡§∏‡§Æ ‡§Ö‡§®‡•Å‡§ï‡•Ç‡§≤ ‡§π‡•à‡•§";
                    
                default:
                    return "";
            }
        }

        // Check for weather alerts
        function checkWeatherAlerts(dailyData) {
            weatherAlert.classList.add('hidden');
            let alertMessage = '';
            let alertType = 'info';
            
            // Check first day's data for immediate alerts
            const today = dailyData[0];
            
            if (today.rain > 15) {
                alertMessage = "‡§ö‡•á‡§§‡§æ‡§µ‡§®‡•Ä: ‡§≠‡§æ‡§∞‡•Ä ‡§¨‡§æ‡§∞‡§ø‡§∂ ‡§ï‡•Ä ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ ‡§π‡•à‡•§ ‡§´‡§∏‡§≤‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§";
                alertType = 'warning';
            } else if (today.windSpeed * 3.6 > 40) {
                alertMessage = "‡§ö‡•á‡§§‡§æ‡§µ‡§®‡•Ä: ‡§§‡•á‡§ú ‡§π‡§µ‡§æ‡§ì‡§Ç ‡§ï‡•Ä ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ ‡§π‡•à‡•§ ‡§´‡§∏‡§≤‡•ã‡§Ç ‡§ï‡•ã ‡§¢‡§ï ‡§ï‡§∞ ‡§∞‡§ñ‡•á‡§Ç‡•§";
                alertType = 'warning';
            } else if (today.maxTemp > 35) {
                alertMessage = "‡§∏‡§≤‡§æ‡§π: ‡§â‡§ö‡•ç‡§ö ‡§§‡§æ‡§™‡§Æ‡§æ‡§® ‡§ï‡•Ä ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ ‡§π‡•à‡•§ ‡§´‡§∏‡§≤‡•ã‡§Ç ‡§ï‡•ã ‡§™‡§∞‡•ç‡§Ø‡§æ‡§™‡•ç‡§§ ‡§™‡§æ‡§®‡•Ä ‡§¶‡•á‡§Ç‡•§";
                alertType = 'info';
            } else if (today.minTemp < 5) {
                alertMessage = "‡§∏‡§≤‡§æ‡§π: ‡§®‡§ø‡§Æ‡•ç‡§® ‡§§‡§æ‡§™‡§Æ‡§æ‡§® ‡§ï‡•Ä ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ ‡§π‡•à‡•§ ‡§®‡§æ‡§ú‡•Å‡§ï ‡§´‡§∏‡§≤‡•ã‡§Ç ‡§ï‡•ã ‡§¢‡§ï ‡§ï‡§∞ ‡§∞‡§ñ‡•á‡§Ç‡•§";
                alertType = 'info';
            } else {
                alertMessage = "‡§Æ‡•å‡§∏‡§Æ ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§π‡•à‡•§ ‡§´‡§∏‡§≤‡•ã‡§Ç ‡§ï‡•Ä ‡§®‡§ø‡§Ø‡§Æ‡§ø‡§§ ‡§¶‡•á‡§ñ‡§≠‡§æ‡§≤ ‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡•á‡§Ç‡•§";
                alertType = 'success';
            }
            
            if (alertMessage) {
                weatherAlert.textContent = alertMessage;
                weatherAlert.className = `alert alert-${alertType}`;
                weatherAlert.classList.remove('hidden');
            }
        }

        // Refresh weather data
        function refreshWeather() {
            // In a real implementation, this would re-fetch the weather data
            // For this demo, we'll just show a message
            alert("‡§Æ‡•å‡§∏‡§Æ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§§‡§æ‡§ú‡§º‡§æ ‡§ï‡•Ä ‡§ú‡§æ ‡§∞‡§π‡•Ä ‡§π‡•à...");
            // In a real app: getWeatherDataByCity(lastSearchedCity) or getLocationByGeolocation()
        }

        // Go back to start screen
        function goBackToStart() {
            weatherDisplay.classList.add('hidden');
            startScreen.classList.remove('hidden');
            manualInputSection.classList.add('hidden');
            locationInput.value = '';
        }

        // Demo data for testing without API key
        function loadDemoData() {
            const demoData = {
                city: {
                    name: "‡§¶‡§ø‡§≤‡•ç‡§≤‡•Ä",
                    country: "IN"
                },
                list: [
                    // Day 1 data
                    {dt: Date.now()/1000, main: {temp: 25, humidity: 60}, weather: [{description: "‡§π‡§≤‡•ç‡§ï‡•á ‡§¨‡§æ‡§¶‡§≤"}], wind: {speed: 3.5}, rain: {'3h': 0}},
                    {dt: Date.now()/1000 + 21600, main: {temp: 28, humidity: 55}, weather: [{description: "‡§π‡§≤‡•ç‡§ï‡•á ‡§¨‡§æ‡§¶‡§≤"}], wind: {speed: 4.2}, rain: {'3h': 0}},
                    {dt: Date.now()/1000 + 43200, main: {temp: 30, humidity: 50}, weather: [{description: "‡§ß‡•Ç‡§™"}], wind: {speed: 5.1}, rain: {'3h': 0}},
                    {dt: Date.now()/1000 + 64800, main: {temp: 26, humidity: 65}, weather: [{description: "‡§π‡§≤‡•ç‡§ï‡•á ‡§¨‡§æ‡§¶‡§≤"}], wind: {speed: 3.8}, rain: {'3h': 0}},
                    // Day 2 data
                    {dt: Date.now()/1000 + 86400, main: {temp: 24, humidity: 70}, weather: [{description: "‡§¨‡§æ‡§¶‡§≤ ‡§õ‡§æ‡§è ‡§∞‡§π‡•á‡§Ç‡§ó‡•á"}], wind: {speed: 4.5}, rain: {'3h': 1}},
                    {dt: Date.now()/1000 + 86400 + 21600, main: {temp: 26, humidity: 65}, weather: [{description: "‡§¨‡§æ‡§¶‡§≤ ‡§õ‡§æ‡§è ‡§∞‡§π‡•á‡§Ç‡§ó‡•á"}], wind: {speed: 5.2}, rain: {'3h': 2}},
                    {dt: Date.now()/1000 + 86400 + 43200, main: {temp: 28, humidity: 60}, weather: [{description: "‡§π‡§≤‡•ç‡§ï‡•Ä ‡§¨‡§æ‡§∞‡§ø‡§∂"}], wind: {speed: 6.0}, rain: {'3h': 5}},
                    {dt: Date.now()/1000 + 86400 + 64800, main: {temp: 23, humidity: 75}, weather: [{description: "‡§π‡§≤‡•ç‡§ï‡•Ä ‡§¨‡§æ‡§∞‡§ø‡§∂"}], wind: {speed: 4.8}, rain: {'3h': 3}},
                    // Day 3 data
                    {dt: Date.now()/1000 + 172800, main: {temp: 22, humidity: 80}, weather: [{description: "‡§¨‡§æ‡§∞‡§ø‡§∂"}], wind: {speed: 5.5}, rain: {'3h': 8}},
                    {dt: Date.now()/1000 + 172800 + 21600, main: {temp: 23, humidity: 78}, weather: [{description: "‡§¨‡§æ‡§∞‡§ø‡§∂"}], wind: {speed: 6.2}, rain: {'3h': 10}},
                    {dt: Date.now()/1000 + 172800 + 43200, main: {temp: 24, humidity: 75}, weather: [{description: "‡§π‡§≤‡•ç‡§ï‡•Ä ‡§¨‡§æ‡§∞‡§ø‡§∂"}], wind: {speed: 5.8}, rain: {'3h': 6}},
                    {dt: Date.now()/1000 + 172800 + 64800, main: {temp: 21, humidity: 82}, weather: [{description: "‡§¨‡§æ‡§¶‡§≤ ‡§õ‡§æ‡§è ‡§∞‡§π‡•á‡§Ç‡§ó‡•á"}], wind: {speed: 4.9}, rain: {'3h': 2}},
                    // Day 4 data
                    {dt: Date.now()/1000 + 259200, main: {temp: 20, humidity: 70}, weather: [{description: "‡§π‡§≤‡•ç‡§ï‡•á ‡§¨‡§æ‡§¶‡§≤"}], wind: {speed: 4.0}, rain: {'3h': 0}},
                    {dt: Date.now()/1000 + 259200 + 21600, main: {temp: 23, humidity: 65}, weather: [{description: "‡§ß‡•Ç‡§™"}], wind: {speed: 4.5}, rain: {'3h': 0}},
                    {dt: Date.now()/1000 + 259200 + 43200, main: {temp: 26, humidity: 60}, weather: [{description: "‡§ß‡•Ç‡§™"}], wind: {speed: 5.0}, rain: {'3h': 0}},
                    {dt: Date.now()/1000 + 259200 + 64800, main: {temp: 22, humidity: 68}, weather: [{description: "‡§∏‡§æ‡§´"}], wind: {speed: 4.2}, rain: {'3h': 0}}
                ]
            };
            
            displayWeatherData(demoData);
        }

        // If API key is not set, use demo data
        if (API_KEY === "YOUR_OPENWEATHER_API_KEY_HERE") {
            // Add demo button for testing
            const demoButton = document.createElement('button');
            demoButton.className = 'btn btn-outline';
            demoButton.textContent = 'Demo Data ‡§¶‡•á‡§ñ‡•á‡§Ç (‡§¨‡§ø‡§®‡§æ API ‡§ï‡•á)';
            demoButton.style.marginTop = '10px';
            demoButton.addEventListener('click', loadDemoData);
            document.querySelector('.location-options').appendChild(demoButton);
        }
    </script>
</body>
</html>